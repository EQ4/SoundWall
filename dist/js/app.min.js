/*
 soundwall 2014-05-01 
*/
$(function(){function a(){console.log("building grid"),r=!1;var a=0,b=0,c=$("#grid");for(a=0;j>a;a++)for(b=0;i>b;b++){var d=$("<audio/>").attr("id","widget"+a+b),e=$("<img/>").attr("id","img"+a+b),f=$("<h2/>");d.attr("loop","true"),d.attr("controls","true"),d.attr("autoplay","true"),e.width(m),e.height(n),c.append(e),c.append(f),c.append(d),o.push(d)}a=0,b=0,$("img").each(function(){var c=$(this).height(),d=$(this).position(),e=d.top,f=(d.left,d.top+c-$(o[a]).height());$(p[a]).css({position:"absolute",top:e+"px",left:b*m+"px",width:m+"px"}),$(o[a]).css({position:"absolute",top:f+"px",left:b*m+"px",width:m+"px"}),a++,b++,b>=i&&(b=0)}),p=$("h2"),q=$("img")}function b(){$("audio").remove(),$("img").remove(),$("h2").remove(),o=[],p=[],q=[]}function c(a){a.shiftKey&&76==a.which&&(r=!r)}function d(c){b(),a(),SC.get("/tracks",{q:c,limit:5*i*j},function(a){a.sort(function(){return.5-Math.random()}),e(a)})}function e(a){g=Math.min(o.length,a.length);for(var b=0;g>b;b++){var c=o[b];c.attr("src",a[b].stream_url+"?client_id="+h),c[0].volume=0,c[0].play(),$(p[b]).text(a[b].title),q[b].src=a[b].artwork_url?a[b].artwork_url.replace("large","t500x500"):"images/default.png"}}function f(a,b){var c;if(0>a||0>b)for(c=0;c<o.length;c++)q[c].hasClass("active")&&(q[c].removeClass("active"),p.eq(c).removeClass("active"));else for(c=0;c<o.length;c++)c!=a*i+b&&(o[c][0].volume=0,q.eq(c).hasClass("active")&&(q.eq(c).removeClass("active"),p.eq(c).removeClass("active")))}$(document).height($(window).height()),$("#grid").height($(document).height()-$("#header").height()),$("#intro-modal").modal("show");var g,h="5371eb9743a8c619876d4e967d558f82",i=3,j=2,k=-1,l=-1,m=$("#grid").width()/i,n=$("#grid").height()/j,o=[],p=[],q=[],r=!1;SC.initialize({client_id:h}),$("#intro-modal").on("hide.bs.modal",function(){d("armin van buuren")}),$("#searchterm").keypress(function(a){if(13==a.which){ga("send","event","input","search"),a.preventDefault();var b=$("#searchterm").val();d(b)}}),$(window).keypress(function(a){ga("send","event","input","locking"),c(a)}),$("#grid").mouseover(function(a){if(!r){ga("send","event","input","playtrack");var b=a.clientX,c=a.clientY-$("#search").height(),d=Math.max(Math.min(Math.floor(c/n),j-1),0),e=Math.min(Math.floor(b/m),i-1);console.log(d,e),$("#widget"+d+e)[0].volume=1,q.eq(d*i+e).addClass("active"),p.eq(d*i+e).addClass("active"),f(d,e),k=d,l=e}})});