/*
 soundwall 2014-05-01 
*/
$(function(){function a(){console.log("building grid"),p=!1;var a=0,b=0,c=$("#grid");for(a=0;j>a;a++)for(b=0;i>b;b++){var d=$("<audio/>").attr("id","widget"+a+b),e=$("<img/>").attr("id","img"+a+b),f=$("<h2/>");d.attr("loop","true"),d.attr("controls","true"),d.attr("autoplay","true"),e.width(m),e.height(n),c.append(e),c.append(f),c.append(d),o.push(d)}var g=$("h2");a=0,b=0,$("img").each(function(){var c=$(this).height(),d=$(this).position(),e=d.top,f=(d.left,d.top+c-$(o[a]).height());$(g[a]).css({position:"absolute",top:e+"px",left:b*m+"px",width:m+"px"}),$(o[a]).css({position:"absolute",top:f+"px",left:b*m+"px",width:m+"px"}),a++,b++,b>=i&&(b=0)})}function b(){$("audio").remove(),$("img").remove(),$("h2").remove(),o=[]}function c(a){a.shiftKey&&76==a.which&&(p=!p)}function d(c){b(),a(),SC.get("/tracks",{q:c,limit:5*i*j},function(a){a.sort(function(){return.5-Math.random()}),e(a)})}function e(a){g=Math.min(o.length,a.length);var b=$("img"),c=$("h2");console.log(c);for(var d=0;g>d;d++){var e=o[d];e.attr("src",a[d].stream_url+"?client_id="+h),e[0].volume=0,e[0].play(),$(c[d]).text(a[d].title),b[d].src=a[d].artwork_url?a[d].artwork_url.replace("large","t500x500"):"images/default.png"}}function f(a,b){var c,d=$("img"),e=$("h2");if(0>a||0>b)for(c=0;c<o.length;c++)d[c].hasClass("active")&&(d[c].removeClass("active"),e.eq(c).removeClass("active"));else for(c=0;c<o.length;c++)c!=a*i+b&&(o[c][0].volume=0,d.eq(c).hasClass("active")&&(d.eq(c).removeClass("active"),e.eq(c).removeClass("active")))}$(document).height($(window).height()),$("#grid").height($(document).height()-$("#header").height()),$("#intro-modal").modal("show");var g,h="5371eb9743a8c619876d4e967d558f82",i=3,j=2,k=-1,l=-1,m=$("#grid").width()/i,n=$("#grid").height()/j,o=[],p=!1;SC.initialize({client_id:h}),$("#intro-modal").on("hide.bs.modal",function(){d("armin van buuren")}),$("#searchterm").keypress(function(a){if(13==a.which){ga("send","event","input","search"),a.preventDefault();var b=$("#searchterm").val();d(b)}}),$(window).keypress(function(a){ga("send","event","input","locking"),c(a)}),$("#grid").mouseover(function(a){if(!p){ga("send","event","input","playtrack");var b=a.clientX,c=a.clientY-$("#search").height(),d=Math.max(Math.min(Math.floor(c/n),j-1),0),e=Math.min(Math.floor(b/m),i-1);console.log(d,e);var g=$("img"),h=$("h2");$("#widget"+d+e)[0].volume=1,g.eq(d*i+e).addClass("active"),h.eq(d*i+e).addClass("active"),f(d,e),k=d,l=e}})});